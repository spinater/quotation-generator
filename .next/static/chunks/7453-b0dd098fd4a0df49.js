"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7453],{1653:(t,e,n)=>{n.d(e,{Vn:()=>i,hj:()=>r});let a=["","หนึ่ง","สอง","สาม","สี่","ห้า","หก","เจ็ด","แปด","เก้า"],o=["","สิบ","ร้อย","พัน","หมื่น","แสน","ล้าน"];function i(t){if(0===t)return"ศูนย์บาทถ้วน";if(t<0)return"ลบ"+i(Math.abs(t));let e=Math.floor(t),n=Math.round((t-e)*100),a="";return e>0&&(a=l(e)+"บาท"),n>0?a+=l(n)+"สตางค์":a+="ถ้วน",a}function l(t){if(0===t)return"";if(t>=1e6){let e=Math.floor(t/1e6),n=t%1e6;return l(e)+"ล้าน"+l(n)}let e="",n=t.toString().split("").map(Number),i=n.length;for(let t=0;t<i;t++){let l=n[t],r=i-t;if(0!==l){if(2===r&&1===l&&2===i){e+="สิบ";continue}if(1===r&&1===l&&i>1){e+="เอ็ด";continue}if(2===r&&2===l){e+="ยี่สิบ";continue}e+=a[l],r>1&&r<=6&&(e+=o[r-1])}}return e}function r(t){return"(".concat(i(t),")")}},7453:(t,e,n)=>{n.d(e,{A_:()=>b,LP:()=>S,_M:()=>x,hk:()=>z});var a=n(1653);let o={th:{quotation:"ใบเสนอราคา",invoice:"ใบแจ้งหนี้",receipt:"ใบเสร็จรับเงิน",quotationNo:"เลขที่",invoiceNo:"เลขที่",receiptNo:"เลขที่",customer:"ลูกค้า",taxId:"เลขประจำตัวผู้เสียภาษี",address:"ที่อยู่",phone:"โทรศัพท์",email:"อีเมล",issueDate:"วันที่",validUntil:"ใช้ได้ถึง",dueDate:"กำหนดชำระ",paymentMethod:"วิธีการชำระเงิน",no:"ลำดับ",description:"รายการ",quantity:"จำนวน",unit:"หน่วย",pricePerUnit:"ราคา/หน่วย",amount:"จำนวนเงิน",subtotal:"ยอดรวม",vat:"ภาษีมูลค่าเพิ่ม 7%",withholdingTax:"หัก ณ ที่จ่าย",total:"ยอดรวมทั้งสิ้น",netTotal:"รวมทั้งสิ้น",totalInWords:"ตัวอักษร",bankDetails:"รายละเอียดบัญชีธนาคาร",bankName:"ธนาคาร",accountNumber:"เลขที่บัญชี",accountName:"ชื่อบัญชี",authorizedSignature:"ลายเซ็นผู้มีอำนาจ",customerSignature:"ลายเซ็นลูกค้า",notes:"หมายเหตุ"},en:{quotation:"Quotation",invoice:"Invoice",receipt:"Receipt",quotationNo:"No.",invoiceNo:"No.",receiptNo:"No.",customer:"Customer",taxId:"Tax ID",address:"Address",phone:"Phone",email:"Email",issueDate:"Issue Date",validUntil:"Valid Until",dueDate:"Due Date",paymentMethod:"Payment Method",no:"No.",description:"Description",quantity:"Qty",unit:"Unit",pricePerUnit:"Price/Unit",amount:"Amount",subtotal:"Subtotal",vat:"VAT 7%",withholdingTax:"Withholding Tax",total:"Total",netTotal:"Net Total",totalInWords:"In Words",bankDetails:"Bank Account Details",bankName:"Bank",accountNumber:"Account Number",accountName:"Account Name",authorizedSignature:"Authorized Signature",customerSignature:"Customer Signature",notes:"Notes"}},i=(t,e)=>{var n;return(null==(n=o[e])?void 0:n[t])||o.th[t]},l=(t,e)=>{let n="string"==typeof t?new Date(t):t;if(isNaN(n.getTime()))return"";let a=n.getDate(),o={th:["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],en:["January","February","March","April","May","June","July","August","September","October","November","December"]}[e][n.getMonth()],i="th"===e?n.getFullYear()+543:n.getFullYear();return"".concat(a," ").concat(o," ").concat(i)},r=t=>t.toLocaleString("th-TH",{minimumFractionDigits:2,maximumFractionDigits:2}),c={header:{fontSize:18,bold:!0,margin:[0,0,0,10]},subheader:{fontSize:12,bold:!0,margin:[0,5,0,5]},tableHeader:{bold:!0,fontSize:10,fillColor:"#000000",color:"#ffffff"},tableCell:{fontSize:9},small:{fontSize:8},notesTitle:{fontSize:10,bold:!0,margin:[0,0,0,5]},notesText:{fontSize:9}},s=(t,e,n,a,o)=>{let l=[];return n&&l.push({table:{widths:["*"],body:[[{text:[{text:"".concat(i("invoiceNo",a),"\n"),fontSize:9,color:"#000000"},{text:n,fontSize:11,bold:!0,color:"#000000"}],alignment:"center",fillColor:"#f5f5f5",margin:[8,8,8,8],border:[!0,!0,!0,!0]}]]},layout:{hLineWidth:()=>1,vLineWidth:()=>1,hLineColor:()=>"#cccccc",vLineColor:()=>"#cccccc",paddingLeft:()=>0,paddingRight:()=>0,paddingTop:()=>0,paddingBottom:()=>0},margin:[0,0,5,0]}),o.issueDate&&l.push({table:{widths:["*"],body:[[{text:[{text:"".concat(i("issueDate",a),"\n"),fontSize:9,color:"#000000"},{text:o.issueDate,fontSize:11,bold:!0,color:"#000000"}],alignment:"center",fillColor:"#f5f5f5",margin:[8,8,8,8],border:[!0,!0,!0,!0]}]]},layout:{hLineWidth:()=>1,vLineWidth:()=>1,hLineColor:()=>"#cccccc",vLineColor:()=>"#cccccc",paddingLeft:()=>0,paddingRight:()=>0,paddingTop:()=>0,paddingBottom:()=>0},margin:[0,0,5,0]}),o.dueDate?l.push({table:{widths:["*"],body:[[{text:[{text:"".concat(i("dueDate",a),"\n"),fontSize:9,color:"#000000"},{text:o.dueDate,fontSize:11,bold:!0,color:"#000000"}],alignment:"center",fillColor:"#f5f5f5",margin:[8,8,8,8],border:[!0,!0,!0,!0]}]]},layout:{hLineWidth:()=>1,vLineWidth:()=>1,hLineColor:()=>"#cccccc",vLineColor:()=>"#cccccc",paddingLeft:()=>0,paddingRight:()=>0,paddingTop:()=>0,paddingBottom:()=>0},margin:[0,0,0,0]}):o.validUntil&&l.push({table:{widths:["*"],body:[[{text:[{text:"".concat(i("validUntil",a),"\n"),fontSize:9,color:"#000000"},{text:o.validUntil,fontSize:11,bold:!0,color:"#000000"}],alignment:"center",fillColor:"#f5f5f5",margin:[8,8,8,8],border:[!0,!0,!0,!0]}]]},layout:{hLineWidth:()=>1,vLineWidth:()=>1,hLineColor:()=>"#cccccc",vLineColor:()=>"#cccccc",paddingLeft:()=>0,paddingRight:()=>0,paddingTop:()=>0,paddingBottom:()=>0},margin:[0,0,0,0]}),{stack:[{columns:[{width:"*",stack:[{text:"th"===a?t.name:t.nameEn||t.name,fontSize:12,bold:!0},{text:"".concat(i("taxId",a),": ").concat(t.taxId),fontSize:9,margin:[0,2,0,0]},{text:"".concat(i("address",a),": ").concat(t.address),fontSize:9,margin:[0,2,0,0]},{text:"".concat(i("phone",a),": ").concat(t.phone),fontSize:9,margin:[0,2,0,0]}]},{width:"auto",stack:[{text:e,style:"header",alignment:"center",margin:[0,0,0,10]}]}]},{columns:l.map(t=>({width:"*",...t})),columnGap:5,margin:[0,10,0,0]}],margin:[0,0,0,20]}},u=(t,e)=>({stack:[{text:t.customerName,fontSize:10,bold:!0},t.customerTaxId?{text:"".concat(i("taxId",e),": ").concat(t.customerTaxId),fontSize:9}:null,t.customerAddress?{text:"".concat(i("address",e),": ").concat(t.customerAddress),fontSize:9}:null,t.customerPhone?{text:"".concat(i("phone",e),": ").concat(t.customerPhone),fontSize:9}:null].filter(t=>null!==t)}),f=(t,e)=>{let n=[[{text:i("no",e),style:"tableHeader",alignment:"center"},{text:i("description",e),style:"tableHeader"},{text:i("quantity",e),style:"tableHeader",alignment:"center"},{text:i("unit",e),style:"tableHeader",alignment:"center"},{text:i("pricePerUnit",e),style:"tableHeader",alignment:"right"},{text:i("amount",e),style:"tableHeader",alignment:"right"}]];return t.forEach((t,e)=>{n.push([{text:(e+1).toString(),style:"tableCell",alignment:"center"},{text:t.description,style:"tableCell"},{text:t.quantity.toString(),style:"tableCell",alignment:"center"},{text:t.unit,style:"tableCell",alignment:"center"},{text:r(t.pricePerUnit),style:"tableCell",alignment:"right"},{text:r(t.amount),style:"tableCell",alignment:"right"}]),t.subItems&&t.subItems.length>0&&t.subItems.forEach(t=>{n.push([{text:"",style:"tableCell"},{text:"    ".concat(t.description),style:"tableCell",italics:!0},{text:t.quantity.toString(),style:"tableCell",alignment:"center"},{text:t.unit,style:"tableCell",alignment:"center"},{text:r(t.pricePerUnit),style:"tableCell",alignment:"right"},{text:r(t.amount),style:"tableCell",alignment:"right"}])})}),{table:{headerRows:1,widths:[30,"*",50,50,80,80],body:n},layout:{hLineWidth:()=>1,vLineWidth:()=>1,hLineColor:()=>"#e5e7eb",vLineColor:()=>"#e5e7eb"},margin:[0,0,0,20]}},g=(t,e)=>{let n=[];n.push({columns:[{text:i("subtotal",e),fontSize:10},{text:r(t.subtotal||0),fontSize:10,alignment:"right"}],margin:[10,8,10,5]}),t.hasVat&&n.push({columns:[{text:i("vat",e),fontSize:10},{text:r(t.vatAmount||0),fontSize:10,alignment:"right"}],margin:[10,0,10,5]});let o=(t.subtotal||0)+(t.hasVat&&t.vatAmount||0);if(t.hasWithholdingTax){n.push({columns:[{text:i("total",e),fontSize:10},{text:r(t.total||o),fontSize:10,alignment:"right"}],margin:[10,0,10,5]});let a=t.withholdingTaxPercent||3,l="".concat(i("withholdingTax",e)," ").concat(a,"%");n.push({columns:[{text:l,fontSize:10,color:"#dc2626"},{text:"-".concat(r(t.withholdingTaxAmount||0)),fontSize:10,color:"#dc2626",alignment:"right"}],margin:[10,0,10,5]}),n.push({columns:[{text:i("netTotal",e),fontSize:11,bold:!0},{text:r(t.netTotal||0),fontSize:11,bold:!0,alignment:"right"}],margin:[10,5,10,8]})}else n.push({columns:[{text:i("total",e),fontSize:11,bold:!0},{text:r(t.total||o),fontSize:11,bold:!0,alignment:"right"}],margin:[10,5,10,8]});let l=t.hasWithholdingTax?t.netTotal||0:t.total||o;return n.push({text:"".concat(i("totalInWords",e),": ").concat("(".concat((0,a.Vn)(l),")")),fontSize:9,margin:[10,5,10,8]}),{columns:[{width:"*",text:""},{width:240,stack:[{stack:n,fillColor:"#f5f5f5"}]}],margin:[0,10,0,20]}},d=t=>(e,n)=>({text:"".concat("th"===t?"หน้า":"Page"," ").concat(e," / ").concat(n),alignment:"center",fontSize:9,margin:[0,20,0,0]}),m=(t,e)=>t.bankName||t.bankAccountNumber?{stack:[{text:i("bankDetails",e),style:"subheader",fillColor:"#e0f2fe",margin:[5,5,5,2]},{stack:[t.bankName?{text:"".concat(i("bankName",e),": ").concat(t.bankName),fontSize:9,margin:[5,2,5,2]}:null,t.bankAccountNumber?{text:"".concat(i("accountNumber",e),": ").concat(t.bankAccountNumber),fontSize:9,margin:[5,2,5,2]}:null,t.bankAccountName?{text:"".concat(i("accountName",e),": ").concat(t.bankAccountName),fontSize:9,margin:[5,2,5,5]}:null].filter(t=>null!==t),fillColor:"#e0f2fe"}],margin:[0,0,0,20]}:null,h=(t,e)=>{if(!e||!e.signatureName&&!e.signatureUrl&&!e.signatureTitle)return null;let n=[{text:"",margin:[0,0,0,20]}];return e.signatureUrl?n.push({image:e.signatureUrl,width:100,alignment:"center",margin:[0,0,0,10]}):n.push({text:"______________________",alignment:"center",margin:[0,0,0,5]}),e.signatureName&&n.push({text:e.signatureName,alignment:"center",fontSize:10,bold:!0,margin:[0,5,0,2]}),e.signatureTitle&&n.push({text:"(".concat(e.signatureTitle,")"),alignment:"center",fontSize:9,color:"#666666",margin:[0,0,0,0]}),{columns:[{width:"*",text:""},{width:"auto",stack:n},{width:"*",text:""}],margin:[0,30,0,0]}};function b(t){let e=t.language||"th";return{pageSize:"A4",pageMargins:[40,40,40,80],defaultStyle:{font:"Sarabun",fontSize:10},content:[s(t.company,i("quotation",e),t.quotationNumber,e,{issueDate:l(t.issueDate,e),validUntil:l(t.validUntil,e)}),{text:i("customer",e),style:"subheader"},u(t,e),{text:"",margin:[0,0,0,15]},f(t.items,e),g(t,e),m(t.company,e),t.notes?{stack:[{text:i("notes",e),style:"notesTitle"},{text:t.notes,style:"notesText"}],fillColor:"#fffbf0",margin:[5,5,5,5]}:null,h(e,{signatureUrl:t.signatureUrl,signatureName:t.signatureName,signatureTitle:t.signatureTitle})].filter(t=>null!==t),footer:d(e),styles:c}}function S(t){let e=t.language||"th";return{pageSize:"A4",pageMargins:[40,40,40,80],defaultStyle:{font:"Sarabun",fontSize:10},content:[s(t.company,i("invoice",e),t.invoiceNumber,e,{issueDate:l(t.issueDate,e),dueDate:l(t.dueDate,e)}),{text:i("customer",e),style:"subheader"},u(t,e),{text:"",margin:[0,0,0,15]},f(t.items,e),g(t,e),m(t.company,e),t.notes?{stack:[{text:i("notes",e),style:"notesTitle"},{text:t.notes,style:"notesText"}],fillColor:"#fffbf0",margin:[5,5,5,5]}:null,h(e,{signatureUrl:t.signatureUrl,signatureName:t.signatureName,signatureTitle:t.signatureTitle})].filter(t=>null!==t),footer:d(e),styles:c}}function x(t){let e=t.language||"th";return{pageSize:"A4",pageMargins:[40,40,40,80],defaultStyle:{font:"Sarabun",fontSize:10},content:[s(t.company,i("receipt",e),t.receiptNumber,e,{issueDate:l(t.issueDate,e),paymentMethod:t.paymentMethod}),{text:i("customer",e),style:"subheader"},u(t,e),{text:"",margin:[0,0,0,15]},f(t.items,e),g(t,e),m(t.company,e),t.notes?{stack:[{text:i("notes",e),style:"notesTitle"},{text:t.notes,style:"notesText"}],fillColor:"#fffbf0",margin:[5,5,5,5]}:null,h(e,{signatureUrl:t.signatureUrl,signatureName:t.signatureName,signatureTitle:t.signatureTitle})].filter(t=>null!==t),footer:d(e),styles:c}}let p=null,y=null,N=null,T=!1;async function z(){var t;if(p&&T&&y&&N)return console.log("✅ PDFMake already initialized, returning cached instance"),{pdfMake:p,vfs:y,fonts:N};console.log("\uD83D\uDD04 Initializing PDFMake with Thai fonts...");let e=await n.e(5028).then(n.t.bind(n,9536,23)),a=await n.e(8626).then(n.t.bind(n,1984,23)),o=e.default||e,i=(null==(t=a.pdfMake)?void 0:t.vfs)||a.vfs||{};try{console.log("\uD83D\uDCE5 Loading fonts from /fonts/ directory...");let[t,e,n]=await Promise.all([fetch("/fonts/Sarabun-Regular.ttf"),fetch("/fonts/Sarabun-Bold.ttf"),fetch("/fonts/NotoSansThai.ttf")]);if(!t.ok||!e.ok||!n.ok)throw Error("Failed to load fonts: ".concat(!t.ok?"Sarabun-Regular ":"").concat(!e.ok?"Sarabun-Bold ":"").concat(n.ok?"":"NotoSansThai"));console.log("✅ Font files fetched successfully");let[a,l,r]=await Promise.all([t.arrayBuffer(),e.arrayBuffer(),n.arrayBuffer()]);console.log("✅ Font ArrayBuffers created");let c=t=>{let e=new Uint8Array(t),n="";for(let t=0;t<e.byteLength;t++)n+=String.fromCharCode(e[t]);return btoa(n)},s=c(a),u=c(l),f=c(r);console.log("✅ Fonts converted to base64"),console.log("  - Sarabun-Regular: ".concat(s.length," chars")),console.log("  - Sarabun-Bold: ".concat(u.length," chars")),console.log("  - NotoSansThai: ".concat(f.length," chars"));let g={...i,"Sarabun-Regular.ttf":s,"Sarabun-Bold.ttf":u,"NotoSansThai.ttf":f},d={Sarabun:{normal:"Sarabun-Regular.ttf",bold:"Sarabun-Bold.ttf",italics:"Sarabun-Regular.ttf",bolditalics:"Sarabun-Bold.ttf"},NotoSansThai:{normal:"NotoSansThai.ttf",bold:"NotoSansThai.ttf",italics:"NotoSansThai.ttf",bolditalics:"NotoSansThai.ttf"},Roboto:{normal:"Roboto-Regular.ttf",bold:"Roboto-Medium.ttf",italics:"Roboto-Italic.ttf",bolditalics:"Roboto-MediumItalic.ttf"}};if(console.log("\uD83D\uDD0D Font configuration complete:"),console.log("  - VFS keys:",{hasSarabunRegular:!!g["Sarabun-Regular.ttf"],hasSarabunBold:!!g["Sarabun-Bold.ttf"],hasNotoSansThai:!!g["NotoSansThai.ttf"]}),console.log("\uD83D\uDD0D Font families available:",Object.keys(d)),console.log("\uD83D\uDD0D VFS object keys count:",Object.keys(g).length),!g["Sarabun-Bold.ttf"])throw Error("Font verification failed: Sarabun-Bold.ttf not found in VFS after configuration");return p=o,y=g,N=d,T=!0,console.log("✅ PDFMake initialized successfully with Thai fonts!"),{pdfMake:o,vfs:g,fonts:d}}catch(t){return console.error("❌ Failed to load Thai fonts:",t),console.error("  Using default fonts as fallback"),p=o,y=i,T=!1,{pdfMake:o,vfs:i,fonts:N={Roboto:{normal:"Roboto-Regular.ttf",bold:"Roboto-Medium.ttf",italics:"Roboto-Italic.ttf",bolditalics:"Roboto-MediumItalic.ttf"}}}}}}}]);