(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6702],{667:(e,s,a)=>{"use strict";a.d(s,{$:()=>t});var r=a(5155);function t(e){let{variant:s="primary",size:a="md",isLoading:t=!1,children:l,className:n="",disabled:d,...c}=e,i="".concat("inline-flex items-center justify-center font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed"," ").concat({primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",ghost:"bg-transparent text-gray-700 hover:bg-gray-100 focus:ring-gray-500 border border-gray-300"}[s]," ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[a]," ").concat(n).trim();return(0,r.jsx)("button",{className:i,disabled:d||t,...c,children:t?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]}):l})}a(2115)},2883:(e,s,a)=>{Promise.resolve().then(a.bind(a,8333))},3723:(e,s,a)=>{"use strict";a.d(s,{J:()=>t});var r=a(5155);function t(e){let{className:s="",children:a,...t}=e;return(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1 ".concat(s).trim(),...t,children:a})}a(2115)},7625:(e,s,a)=>{"use strict";a.d(s,{f:()=>t});var r=a(5155);function t(e){let{label:s,error:a,helperText:t,required:l,className:n="",id:d,...c}=e,i=d||"textarea-".concat(null==s?void 0:s.toLowerCase().replace(/\s+/g,"-")),o="\n    w-full px-3 py-2 border rounded-lg\n    focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\n    disabled:bg-gray-100 disabled:cursor-not-allowed\n    ".concat(a?"border-red-500 focus:ring-red-500":"border-gray-300","\n    ").concat(n,"\n  ").trim().replace(/\s+/g," ");return(0,r.jsxs)("div",{className:"w-full",children:[s&&(0,r.jsxs)("label",{htmlFor:i,className:"block text-sm font-medium text-gray-700 mb-1",children:[s,l&&(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,r.jsx)("textarea",{id:i,className:o,"aria-invalid":a?"true":"false","aria-describedby":a?"".concat(i,"-error"):t?"".concat(i,"-helper"):void 0,...c}),a&&(0,r.jsx)("p",{id:"".concat(i,"-error"),className:"mt-1 text-sm text-red-600",children:a}),!a&&t&&(0,r.jsx)("p",{id:"".concat(i,"-helper"),className:"mt-1 text-sm text-gray-500",children:t})]})}a(2115)},8333:(e,s,a)=>{"use strict";a.d(s,{default:()=>A});var r=a(5155),t=a(2115),l=a(6191),n=a(9347),d=a(1010),c=a(1360),i=a(667),o=a(8829),m=a(3723),x=a(7625),h=a(6100),u=a(5917),p=a(2821),g=a(5889);function b(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,g.QP)((0,p.$)(s))}let f=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(h.bL,{ref:s,className:b("peer h-4 w-4 shrink-0 rounded-sm border border-gray-300 ring-offset-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-blue-600 data-[state=checked]:text-white data-[state=checked]:border-blue-600",a),...t,children:(0,r.jsx)(h.C1,{className:b("flex items-center justify-center text-current"),children:(0,r.jsx)(u.A,{className:"h-4 w-4"})})})});function j(e){let{company:s,onSubmit:a,onCancel:l}=e,[n,d]=(0,t.useState)({name:"",nameEn:"",taxId:"",address:"",phone:"",email:"",bankName:"",bankAccountNumber:"",bankAccountName:"",logo:"",isDefault:!1,isIssuer:!0,isCustomer:!1}),[c,h]=(0,t.useState)(!1),[u,p]=(0,t.useState)({});(0,t.useEffect)(()=>{if(s){var e,a;d({name:s.name,nameEn:s.nameEn||"",taxId:s.taxId,address:s.address,phone:s.phone,email:s.email||"",bankName:s.bankName||"",bankAccountNumber:s.bankAccountNumber||"",bankAccountName:s.bankAccountName||"",logo:s.logo||"",isDefault:s.isDefault,isIssuer:null==(e=s.isIssuer)||e,isCustomer:null!=(a=s.isCustomer)&&a})}},[s]);let g=e=>{let{name:s,value:a}=e.target;d(e=>({...e,[s]:a})),u[s]&&p(e=>{let a={...e};return delete a[s],a})},b=async e=>{if(e.preventDefault(),(()=>{let e={};return n.name.trim()||(e.name="Company name is required"),n.taxId.trim()?/^\d{13}$/.test(n.taxId.replace(/-/g,""))||(e.taxId="Tax ID must be 13 digits"):e.taxId="Tax ID is required",n.address.trim()||(e.address="Address is required"),n.phone.trim()||(e.phone="Phone number is required"),n.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.email)&&(e.email="Invalid email format"),p(e),0===Object.keys(e).length})()){h(!0);try{await a(n)}catch(e){console.error("Error submitting form:",e)}finally{h(!1)}}};return(0,r.jsxs)("form",{onSubmit:b,className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"ข้อมูลพื้นฐาน / Basic Information"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(m.J,{htmlFor:"name",children:"ชื่อบริษัท (ไทย) / Company Name (Thai) *"}),(0,r.jsx)(o.p,{id:"name",name:"name",value:n.name,onChange:g,placeholder:"บริษัท ตัวอย่าง จำกัด",className:u.name?"border-red-500":""}),u.name&&(0,r.jsx)("p",{className:"text-sm text-red-600 mt-1",children:u.name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m.J,{htmlFor:"nameEn",children:"ชื่อบริษัท (อังกฤษ) / Company Name (English)"}),(0,r.jsx)(o.p,{id:"nameEn",name:"nameEn",value:n.nameEn,onChange:g,placeholder:"Example Company Ltd."})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m.J,{htmlFor:"taxId",children:"เลขประจำตัวผู้เสียภาษี / Tax ID (13 digits) *"}),(0,r.jsx)(o.p,{id:"taxId",name:"taxId",value:n.taxId,onChange:g,placeholder:"0-0000-00000-00-0",maxLength:17,className:u.taxId?"border-red-500":""}),u.taxId&&(0,r.jsx)("p",{className:"text-sm text-red-600 mt-1",children:u.taxId})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m.J,{htmlFor:"address",children:"ที่อยู่ / Address *"}),(0,r.jsx)(x.f,{id:"address",name:"address",value:n.address,onChange:g,placeholder:"123 ถนน... แขวง/ตำบล... เขต/อำเภอ... จังหวัด... 10000",rows:3,className:u.address?"border-red-500":""}),u.address&&(0,r.jsx)("p",{className:"text-sm text-red-600 mt-1",children:u.address})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(m.J,{htmlFor:"phone",children:"โทรศัพท์ / Phone *"}),(0,r.jsx)(o.p,{id:"phone",name:"phone",value:n.phone,onChange:g,placeholder:"02-123-4567",className:u.phone?"border-red-500":""}),u.phone&&(0,r.jsx)("p",{className:"text-sm text-red-600 mt-1",children:u.phone})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m.J,{htmlFor:"email",children:"อีเมล / Email"}),(0,r.jsx)(o.p,{id:"email",name:"email",type:"email",value:n.email,onChange:g,placeholder:"contact@example.com",className:u.email?"border-red-500":""}),u.email&&(0,r.jsx)("p",{className:"text-sm text-red-600 mt-1",children:u.email})]})]})]}),(0,r.jsxs)("div",{className:"space-y-4 pt-4 border-t",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"ข้อมูลธนาคาร / Bank Information"}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m.J,{htmlFor:"bankName",children:"ชื่อธนาคาร / Bank Name"}),(0,r.jsx)(o.p,{id:"bankName",name:"bankName",value:n.bankName,onChange:g,placeholder:"ธนาคารกรุงเทพ"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(m.J,{htmlFor:"bankAccountNumber",children:"เลขที่บัญชี / Account Number"}),(0,r.jsx)(o.p,{id:"bankAccountNumber",name:"bankAccountNumber",value:n.bankAccountNumber,onChange:g,placeholder:"123-4-56789-0"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m.J,{htmlFor:"bankAccountName",children:"ชื่อบัญชี / Account Name"}),(0,r.jsx)(o.p,{id:"bankAccountName",name:"bankAccountName",value:n.bankAccountName,onChange:g,placeholder:"บริษัท ตัวอย่าง จำกัด"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-4 pt-4 border-t",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"โลโก้ / Logo"}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m.J,{htmlFor:"logo",children:"URL โลโก้ / Logo URL"}),(0,r.jsx)(o.p,{id:"logo",name:"logo",value:n.logo,onChange:g,placeholder:"https://example.com/logo.png"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Enter a URL for your company logo (optional)"})]}),n.logo&&(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Logo Preview:"}),(0,r.jsx)("img",{src:n.logo,alt:"Company Logo Preview",className:"max-w-xs max-h-32 object-contain border rounded p-2",onError:e=>{e.target.style.display="none"}})]})]}),(0,r.jsxs)("div",{className:"space-y-4 pt-4 border-t",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:"ประเภทบริษัท / Company Type"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(f,{id:"isIssuer",checked:n.isIssuer,onCheckedChange:e=>d(s=>({...s,isIssuer:e}))}),(0,r.jsx)(m.J,{htmlFor:"isIssuer",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"บริษัทออกบิล / Issuer Company (ออกใบแจ้งหนี้/ใบเสนอราคา/ใบเสร็จ)"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(f,{id:"isCustomer",checked:n.isCustomer,onCheckedChange:e=>d(s=>({...s,isCustomer:e}))}),(0,r.jsx)(m.J,{htmlFor:"isCustomer",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"บริษัทลูกค้า / Customer Company (สามารถเลือกเป็นลูกค้าได้)"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 pt-2",children:[(0,r.jsx)(f,{id:"isDefault",checked:n.isDefault,onCheckedChange:e=>{d(s=>({...s,isDefault:e}))}}),(0,r.jsx)(m.J,{htmlFor:"isDefault",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"ตั้งเป็นบริษัทเริ่มต้น / Set as default company"})]})]}),(0,r.jsxs)("div",{className:"flex gap-4 pt-4 border-t",children:[(0,r.jsx)(i.$,{type:"submit",disabled:c,className:"flex-1",children:c?s?"กำลังอัพเดท... / Updating...":"กำลังสร้าง... / Creating...":s?"อัพเดทบริษัท / Update Company":"สร้างบริษัท / Create Company"}),(0,r.jsx)(i.$,{type:"button",variant:"ghost",onClick:l,disabled:c,children:"ยกเลิก / Cancel"})]})]})}f.displayName=h.bL.displayName;var N=a(926);let y=(0,N.createServerReference)("401cd22ed04699fda338b190f90f1d0503d9e0c985",N.callServer,void 0,N.findSourceMapURL,"createCompany"),v=(0,N.createServerReference)("60592c466ce4cfa3d6153466493ad3debd6a182d9b",N.callServer,void 0,N.findSourceMapURL,"updateCompany"),C=(0,N.createServerReference)("40e3df6b3ae823a93e461d7900f9dc1f10a6368729",N.callServer,void 0,N.findSourceMapURL,"deleteCompany"),k=(0,N.createServerReference)("40402fd914f856d97eec9740e99cafbb2cdbf5120e",N.callServer,void 0,N.findSourceMapURL,"setDefaultCompany");var w=a(63);function A(e){let{companies:s}=e,a=(0,w.useRouter)(),[o,m]=(0,t.useState)(s),[x,h]=(0,t.useState)(!1),[u,p]=(0,t.useState)(null),[g,b]=(0,t.useState)(null),f=async e=>{let s=await y(e);s.success?(m(e=>[...e,s.data]),h(!1),a.refresh()):alert(s.error||"Failed to create company")},N=async e=>{if(!u)return;let s=await v(u.id,e);s.success?(m(e=>e.map(e=>e.id===u.id?s.data:e)),p(null),h(!1),a.refresh()):alert(s.error||"Failed to update company")},A=async e=>{if(!confirm("Are you sure you want to delete this company?"))return;b(e);let s=await C(e);b(null),s.success?(m(s=>s.filter(s=>s.id!==e)),a.refresh()):alert(s.error||"Failed to delete company")},I=async e=>{let s=await k(e);s.success?(m(s=>s.map(s=>({...s,isDefault:s.id===e}))),a.refresh()):alert(s.error||"Failed to set default company")},E=()=>{p(null),h(!0)};return(0,r.jsxs)("div",{className:"space-y-6",children:[!x&&(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("p",{className:"text-gray-600",children:["Total companies: ",o.length]}),(0,r.jsxs)(i.$,{onClick:E,children:[(0,r.jsx)(l.A,{className:"w-4 h-4 mr-2"}),"เพิ่มบริษัทใหม่ / Add New Company"]})]}),x&&(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg border",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:u?"แก้ไขข้อมูลบริษัท / Edit Company":"เพิ่มบริษัทใหม่ / Add New Company"}),(0,r.jsx)(j,{company:u||void 0,onSubmit:u?N:f,onCancel:()=>{h(!1),p(null)}})]}),!x&&(0,r.jsx)("div",{className:"space-y-4",children:0===o.length?(0,r.jsxs)("div",{className:"bg-white p-12 rounded-lg border text-center",children:[(0,r.jsx)("p",{className:"text-gray-500 mb-4",children:"No companies yet. Add your first company to get started."}),(0,r.jsxs)(i.$,{onClick:E,children:[(0,r.jsx)(l.A,{className:"w-4 h-4 mr-2"}),"Add Company"]})]}):o.map(e=>(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg border ".concat(e.isDefault?"border-blue-500 border-2":""),children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:e.name}),e.isDefault&&(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium text-blue-700 bg-blue-100 rounded-full",children:[(0,r.jsx)(n.A,{className:"w-3 h-3 mr-1"}),"Default"]})]}),e.nameEn&&(0,r.jsx)("p",{className:"text-gray-600 mb-2",children:e.nameEn}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Tax ID"}),(0,r.jsx)("p",{className:"text-gray-900",children:e.taxId})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Phone"}),(0,r.jsx)("p",{className:"text-gray-900",children:e.phone})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Address"}),(0,r.jsx)("p",{className:"text-gray-900",children:e.address})]}),e.email&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Email"}),(0,r.jsx)("p",{className:"text-gray-900",children:e.email})]}),e.bankName&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Bank"}),(0,r.jsxs)("p",{className:"text-gray-900",children:[e.bankName,e.bankAccountNumber&&" - ".concat(e.bankAccountNumber)]})]})]})]}),e.logo&&(0,r.jsx)("div",{className:"ml-4",children:(0,r.jsx)("img",{src:e.logo,alt:"".concat(e.name," logo"),className:"w-20 h-20 object-contain",onError:e=>{e.target.style.display="none"}})})]}),(0,r.jsxs)("div",{className:"flex gap-2 mt-4 pt-4 border-t",children:[!e.isDefault&&(0,r.jsxs)(i.$,{variant:"ghost",size:"sm",onClick:()=>I(e.id),children:[(0,r.jsx)(n.A,{className:"w-4 h-4 mr-2"}),"Set as Default"]}),(0,r.jsxs)(i.$,{variant:"ghost",size:"sm",onClick:()=>{p(e),h(!0)},children:[(0,r.jsx)(d.A,{className:"w-4 h-4 mr-2"}),"Edit"]}),(0,r.jsxs)(i.$,{variant:"ghost",size:"sm",onClick:()=>A(e.id),disabled:g===e.id,className:"text-red-600 hover:text-red-700",children:[(0,r.jsx)(c.A,{className:"w-4 h-4 mr-2"}),g===e.id?"Deleting...":"Delete"]})]})]},e.id))})]})}},8829:(e,s,a)=>{"use strict";a.d(s,{p:()=>t});var r=a(5155);function t(e){let{label:s,error:a,helperText:t,required:l,className:n="",id:d,...c}=e,i=d||"input-".concat(null==s?void 0:s.toLowerCase().replace(/\s+/g,"-")),o="\n    w-full px-3 py-2 border rounded-lg\n    focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\n    disabled:bg-gray-100 disabled:cursor-not-allowed\n    ".concat(a?"border-red-500 focus:ring-red-500":"border-gray-300","\n    ").concat(n,"\n  ").trim().replace(/\s+/g," ");return(0,r.jsxs)("div",{className:"w-full",children:[s&&(0,r.jsxs)("label",{htmlFor:i,className:"block text-sm font-medium text-gray-700 mb-1",children:[s,l&&(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,r.jsx)("input",{id:i,className:o,"aria-invalid":a?"true":"false","aria-describedby":a?"".concat(i,"-error"):t?"".concat(i,"-helper"):void 0,...c}),a&&(0,r.jsx)("p",{id:"".concat(i,"-error"),className:"mt-1 text-sm text-red-600",children:a}),!a&&t&&(0,r.jsx)("p",{id:"".concat(i,"-helper"),className:"mt-1 text-sm text-gray-500",children:t})]})}a(2115)}},e=>{e.O(0,[346,8441,1255,7358],()=>e(e.s=2883)),_N_E=e.O()}]);